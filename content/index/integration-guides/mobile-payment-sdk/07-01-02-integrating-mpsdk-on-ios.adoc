[#MobilePaymentSDK_iOS]
== Integrating MPSDK on iOS

//-

[#MobilePaymentSDK_iOS_CreditCard]
=== Credit Card

==== Supported https://docs.getneteurope.com/AppendixB.html[Transaction Types]

This payment method supports the following
https://docs.getneteurope.com/AppendixB.html[transaction
types]:

* *`SDKPayECTransactionTypeAuthorization`* - places the account holder’s
funds on hold, pending future capture, re-authorization or void
transaction.
* *`SDKPayECTransactionTypeAuthorizationOnly`* - verifies the validity
of account holder’s card, but does not leave an authorized amount.
* *`SDKPayECTransactionTypePurchase`* - todo.
* *`SDKPayECTransactionTypeReferencedPurchase`* - todo.
* *`SDKPayECTransactionTypeTokenize`* - todo.


[#MobilePaymentSDK_iOS_CreditCard_basic_setup]
==== Basic Setup

[#MobilePaymentSDK_iOS_CreditCard_basic_setup_cocoapods]
===== Cocoapods

Add to your app’s `Podfile` subspecs:
 
[source,ruby]
----
pod 'paymentSDK/Card',          '~> {{version}}'
----

[#MobilePaymentSDK_iOS_CreditCard_basic_payment]
==== Basic Credit Card Payment

This is a code example for a basic Credit Card payment:


[source,swift]
----
// 1. Initialize ``SDKPayECClient``
do {
    try self.client = SDKPayECClient.init(hostname: hostname)
} catch {
    // the device is checked during initialization for jailbreak.
    // It is risky to make payments on jailbroken devices.
    return
}

// 2. Initialize payment object and set mandatory properties
// Parameters (amount, currency, transactionType) shall be sent to server for validation or just provided by server
// and used to generate signature. Signature MUST be generated on server side.
// Signature doc: https://document-center.wirecard.com/display/PTD/Signature+v2
// Secret Key shall never be stored in application.

let payment = SDKPayECCardPayment()
payment.merchantAccountID = merchantAccountID  // provided by merchant support
payment.requestID = requestID                  // generated on server; unique for merchantAccountID
payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
payment.currency = "EUR"
payment.transactionType = .purchase

// 3. Trigger the payment and handle response in payment completion block.
self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?, error: Error?) in
// for each failure error object is provided;
    if let error = error {
        return
    }
    self.handleResponse(response)
})
```
----

//-

[TIP]
====
You can set optional parameters after the payment object is
created. Check the API documentation: http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECCardPayment.html[`SDKPayECCardPayment`]
for more details. Credit Card payment supports
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`]
recurring type.
====

//-

[#MobilePaymentSDK_iOS_CreditCard_recurring_payment]
==== Recurring Credit Card Payment

On a basic level, recurring payments have two phases:

[arabic]
. The initial request, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeFirst`].
. The follow-up requests, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeRecurring`],
* http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]value
from the initial request.

So in order to create a recurring payment, you need to:

[arabic]
. Send a initial request with the appropriate periodic and sequence
flags,
. Save the values of
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]
field generated in this first payment,
. Reference these values in the follow-up request, then send it with
appropriate periodic and sequence flags.

This is a code example for a first recurring Credit Card payment:
[source,swift]
----
// First payment 

let firstPeriodicType = SDKPayECPeriodic() 
firstPeriodicType.periodicType = .recurring
firstPeriodicType.sequenceType = .first

let payment = SDKPayECCardPayment()
payment.merchantAccountID = merchantAccountID  
payment.requestID = requestID
payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
payment.currency = "EUR"
payment.transactionType = .debit
let periodic = SDKPayECPeriodic()
periodic.periodicType = periodicType
periodic.sequenceType = sequenceType
payment.periodic = firstPeriodicType
payment.signature = signature
  
var parentTransactionID: String?
self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
    // for each failure error object is provided;
    if let error = error {
        return
    }
    self.handleResponse(response)
})

// Handle first result
func handleReponse(_ response: SDKPayECPaymentResponse?) {
    guard let response = response else { return }
    self.parentTransactionID = response.parentTransactionID
}

// Second payment using parentTransactionId

let firstPeriodicType = SDKPayECPeriodic()
firstPeriodicType.periodicType = .recurring
firstPeriodicType.sequenceType = .final
  
let payment = SDKPayECCardPayment()
payment.merchantAccountID = merchantAccountID  
payment.requestID = requestID
payment.parentTransactionID = self.parentTransactionID
payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
payment.currency = "EUR"
payment.transactionType = .autorization

let periodic = SDKPayECPeriodic()
periodic.periodicType = periodicType
periodic.sequenceType = sequenceType
payment.periodic = firstPeriodicType
payment.signature = signature

self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
    // for each failure error object is provided;
    if let error = error {
        return
    }
    self.handleResponse(response)
})
```
----

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton]
==== Visualisation

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_Card]
===== Card

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/credit-card-screen.png[Card Screen, align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_Card_CustomizingVisuals]
===== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`
. `SDKPayECSubmitButton`
. `SDKPayECAmountLabel`
. `SDKPayECTextField`


//-
[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_CardAnimated]
===== Card Animated

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/credit-card-animated-screen.png[Animated Card Screen,, align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_CardAnimated_CustomizingVisuals]
====== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`

//-

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_CardField]
===== CardField

``SDKPayCardField`` is a specialized field for collecting card data, with
properties similar to ``UITextField``. It is designed to fit in a single
line and can be used where an ``UITextField`` would be appropriate:

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/credit-cardfield.png[Card Field, align=center, width=240, height=420]


Create a ``SDKPayCardField`` (programmatically, or in XIB/Storyboard) and
keep the instance reference in your ``UIViewController``:

[source,swift]
----
class CardfieldVC: UIViewController, SDKPayECCardFieldDelegate {
    
    @IBOutlet weak var cardField: SDKPayECCardField!
    @IBOutlet weak var payBtn: UIButton!
```
}
----

//-
[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_CardField_CustomizingVisuals]
====== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`

//-

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_CardFieldAnimated]
===== CardField Animated Alternative

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/credit-cardfield-animated.png[Animated Card Field,align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_CreditCard_Visualisaton_CardFieldAnimated_CustomizingVisuals]
====== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`

//-


[#MobilePaymentSDK_iOS_PayPal]
=== PayPal

==== Supported https://docs.getneteurope.com/AppendixB.html[Transaction Types]

This payment method supports the following
https://docs.getneteurope.com/AppendixB.html[transaction
types]:

* *`SDKPayECTransactionTypeAuthorization`* - places the account holder’s
funds on hold, pending future capture, re-authorization or void
transaction.
* *`SDKPayECTransactionTypeAuthorizationOnly`* - todo
* *`SDKPayECTransactionTypeDebit`* - todo.

[#MobilePaymentSDK_iOS_PayPal_basic_setup]
==== Basic Setup

[#MobilePaymentSDK_iOS_PayPal_basic_setup_cocoapods]
===== Cocoapods

Add to your app’s `Podfile` subspecs:
 
[source,ruby]
----
pod 'paymentSDK/PayPal',          '~> {{version}}'
----

[#MobilePaymentSDK_iOS_PayPal_basic_payment]
==== PayPal Payment

This is a code example for a basic PayPal payment:


[source,swift]
----
// 1. Initialize ``SDKPayECClient``
   do {
      try self.client = SDKPayECClient.init(hostname: hostname)
   } catch {
      // the device is checked during initialization for jailbreak.
      // It is risky to make payments on jailbroken devices.
      return
   }

// 2. Initialize payment object and set mandatory properties
// Parameters (amount, currency, transactionType) shall be sent to server for validation or just provided by server
// and used to generate signature. Signature MUST be generated on server side.
// Signature doc: https://document-center.wirecard.com/display/PTD/Signature+v2
// Secret Key shall never be stored in application.

   let orderItem = SDKPayECOrderItem()
   orderItem.name = "The Watch"
   orderItem.amount = AMOUNT;
   orderItem.amountCurrency = .EUR;

   let order = SDKPayECOrder()
   order.descriptor = "DEMO DESCRIPTOR"
   order.number = NSUUID.init().uuidString
   order.detail = "DEMO ORDER DETAIL"
   order.items = [orderItem]

   let payment = SDKPayECPayPalPayment()
   payment.appScheme = "example";
   payment.amount = AMOUNT
   payment.currency = "EUR"
   payment.transactionType = .authorization
   payment.order = order;

   let accountHolder = SDKPayECCustomerData.init()
   accountHolder.lastName = "Doe"
   payment.accountHolder = accountHolder

```
----

//-

[TIP]
====
You can set optional parameters after the payment object is
created. Check the API documentation: http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayPalPayment.html[`SDKPayECPayPalPayment`]
for more details. PayPal payment supports
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`]
recurring type.
====

//-

[#MobilePaymentSDK_iOS_PayPal_recurring_payment]
==== Recurring PayPal Payment

On a basic level, recurring payments have two phases:

[arabic]
. The initial request, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeFirst`].
. The follow-up requests, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeRecurring`],
* http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]value
from the initial request.

So in order to create a recurring payment, you need to:

[arabic]
. Send a initial request with the appropriate periodic and sequence
flags,
. Save the values of
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]
field generated in this first payment,
. Reference these values in the follow-up request, then send it with
appropriate periodic and sequence flags.

This is a code example for a first recurring PayPal payment:
[source,swift]
----
// First payment 

   let firstPeriodicType = SDKPayECPeriodic() 
   firstPeriodicType.periodicType = .recurring
   firstPeriodicType.sequenceType = .first

   let payment = SDKPayECPayPalPayment()
   payment.merchantAccountID = merchantAccountID  
   payment.requestID = requestID
   payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
   payment.currency = "EUR"
   payment.transactionType = .debit
   let periodic = SDKPayECPeriodic()
   periodic.periodicType = periodicType
   periodic.sequenceType = sequenceType
   payment.periodic = firstPeriodicType
   payment.signature = signature
   
   var parentTransactionID: String?
   self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
      // for each failure error object is provided;
      if let error = error {
         return
      }
      self.handleResponse(response)
   })

   // Handle first result
   func handleReponse(_ response: SDKPayECPaymentResponse?) {
      guard let response = response else { return }
      self.parentTransactionID = response.parentTransactionID
   }

   // Second payment using parentTransactionId

   let firstPeriodicType = SDKPayECPeriodic()
   firstPeriodicType.periodicType = .recurring
   firstPeriodicType.sequenceType = .final
   
   let payment = SDKPayECPayPalPayment()
   payment.merchantAccountID = merchantAccountID  
   payment.requestID = requestID
   payment.parentTransactionID = self.parentTransactionID
   payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
   payment.currency = "EUR"
   payment.transactionType = .autorization

   let periodic = SDKPayECPeriodic()
   periodic.periodicType = periodicType
   periodic.sequenceType = sequenceType
   payment.periodic = firstPeriodicType
   payment.signature = signature

   self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
      // for each failure error object is provided;
      if let error = error {
         return
      }
      self.handleResponse(response)
   })
```
----

[#MobilePaymentSDK_iOS_PayPal_Visualisaton]
==== Visualisation

image::images/screens/iOS/paypal.png[PayPal Screen, align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_PayPal_Visualisaton_Card_CustomizingVisuals]
===== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`


[#MobilePaymentSDK_iOS_SEPA]
=== SEPA Direct Debit

==== Supported https://docs.getneteurope.com/AppendixB.html[Transaction Types]

This payment method supports the following
https://docs.getneteurope.com/AppendixB.html[transaction
types]:

* *`SDKPayECTransactionTypeAuthorization`* - places the account holder’s
funds on hold, pending future capture, re-authorization or void
transaction.
* *`SDKPayECTransactionTypeAuthorizationOnly`* - todo
* *`SDKPayECTransactionTypeDebit`* - todo.
* *`SDKPayECTransactionPendingDebit`* - todo.

[#MobilePaymentSDK_iOS_SEPA_basic_setup]
==== Basic Setup

[#MobilePaymentSDK_iOS_SEPA_basic_setup_cocoapods]
===== Cocoapods

Add to your app’s `Podfile` subspecs:
 
[source,ruby]
----
pod 'paymentSDK/SEPA',          '~> {{version}}'
----

[#MobilePaymentSDK_iOS_SEPA_basic_payment]
==== SEPA Payment

This is a code example for a basic SEPA payment:


[source,swift]
----
// 1. Initialize ``SDKPayECClient``
   do {
      try self.client = SDKPayECClient.init(hostname: hostname)
   } catch {
      // the device is checked during initialization for jailbreak.
      // It is risky to make payments on jailbroken devices.
      return
   }

// 2. Initialize payment object and set mandatory properties
// Parameters (amount, currency, transactionType) shall be sent to server for validation or just provided by server
// and used to generate signature. Signature MUST be generated on server side.
// Signature doc: https://document-center.wirecard.com/display/PTD/Signature+v2
// Secret Key shall never be stored in application.

   let payment = SDKPayECSEPAPayment()
   payment.appScheme = "example";
   payment.amount = AMOUNT
   payment.currency = "EUR"
   payment.transactionType = .debit

```
----

//-

[TIP]
====
You can set optional parameters after the payment object is
created. Check the API documentation: http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECSEPAPayment.html[`SDKPayECSEPAPayment`]
for more details. SEPA payment supports
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`]
recurring type.
====

//-

[#MobilePaymentSDK_iOS_SEPA_recurring_payment]
==== Recurring SEPA Payment

On a basic level, recurring payments have two phases:

[arabic]
. The initial request, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeFirst`].
. The follow-up requests, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeRecurring`],
* http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]value
from the initial request.

So in order to create a recurring payment, you need to:

[arabic]
. Send a initial request with the appropriate periodic and sequence
flags,
. Save the values of
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]
field generated in this first payment,
. Reference these values in the follow-up request, then send it with
appropriate periodic and sequence flags.

This is a code example for a first recurring SEPA payment:
[source,swift]
----
// First payment 

   let firstPeriodicType = SDKPayECPeriodic() 
   firstPeriodicType.periodicType = .recurring
   firstPeriodicType.sequenceType = .first

   let payment = SDKPayECSEPAPayment()
   payment.merchantAccountID = merchantAccountID  
   payment.requestID = requestID
   payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
   payment.currency = "EUR"
   payment.transactionType = .debit
   let periodic = SDKPayECPeriodic()
   periodic.periodicType = periodicType
   periodic.sequenceType = sequenceType
   payment.periodic = firstPeriodicType
   payment.signature = signature
   
   var parentTransactionID: String?
   self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
      // for each failure error object is provided;
      if let error = error {
         return
      }
      self.handleResponse(response)
   })

   // Handle first result
   func handleReponse(_ response: SDKPayECPaymentResponse?) {
      guard let response = response else { return }
      self.parentTransactionID = response.parentTransactionID
   }

   // Second payment using parentTransactionId

   let firstPeriodicType = SDKPayECPeriodic()
   firstPeriodicType.periodicType = .recurring
   firstPeriodicType.sequenceType = .final
   
   let payment = SDKPayECSEPAPayment()
   payment.merchantAccountID = merchantAccountID  
   payment.requestID = requestID
   payment.parentTransactionID = self.parentTransactionID
   payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
   payment.currency = "EUR"
   payment.transactionType = .autorization

   let periodic = SDKPayECPeriodic()
   periodic.periodicType = periodicType
   periodic.sequenceType = sequenceType
   payment.periodic = firstPeriodicType
   payment.signature = signature

   self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
      // for each failure error object is provided;
      if let error = error {
         return
      }
      self.handleResponse(response)
   })
```
----

[#MobilePaymentSDK_iOS_SEPA_Visualisaton]
==== Visualisation

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/sepa.png[SEPA Screen, align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_SEPA_Visualisaton_Card_CustomizingVisuals]
===== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECView`
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECSubmitButton`
. `SDKPayECNavigationBar`
. `SDKPayECAmountLabel`
. `SDKPayECTextField`
. `SDKPayECSwitch` 




[#MobilePaymentSDK_iOS_Alipay]
=== Alipay Cross Border

==== Supported https://docs.getneteurope.com/AppendixB.html[Transaction Types]

This payment method supports the following
https://docs.getneteurope.com/AppendixB.html[transaction
types]:

 *`SDKPayECTransactionTypeDebit`* - todo.

[#MobilePaymentSDK_iOS_Alipay_basic_setup]
==== Basic Setup

[#MobilePaymentSDK_iOS_Alipay_basic_setup_cocoapods]
===== Cocoapods

Add to your app’s `Podfile` subspecs:
 
[source,ruby]
----
pod 'paymentSDK/Alipay',          '~> {{version}}'
----

[#MobilePaymentSDK_iOS_Alipay_basic_payment]
==== Alipay Payment

This is a code example for a basic Alipay payment:


[source,swift]
----
// 1. Initialize ``SDKPayECClient``
   do {
      try self.client = SDKPayECClient.init(hostname: hostname)
   } catch {
      // the device is checked during initialization for jailbreak.
      // It is risky to make payments on jailbroken devices.
      return
   }

// 2. Initialize payment object and set mandatory properties
// Parameters (amount, currency, transactionType) shall be sent to server for validation or just provided by server
// and used to generate signature. Signature MUST be generated on server side.
// Signature doc: https://document-center.wirecard.com/display/PTD/Signature+v2
// Secret Key shall never be stored in application.

   let payment = SDKPayECAlipayPayment()
   payment.amount = AMOUNT
   payment.currency = SDKPayECCurrencyGetISOCode(SDKPayECCurrency.USD)

   let localize = SDKPayECLocalize.appearance()
   let locale_de = localize.locale == ._de;

   payment.transactionType = SDKPayECTransactionType.debit
   payment.ipAddress = "127.0.0.1"

   let accountHolder = SDKPayECCustomerData.init()
   accountHolder.firstName = "John"
   accountHolder.lastName = "Doe"
   accountHolder.email = "john.doe@getneteurope.com"
   payment.accountHolder = accountHolder

   let order = SDKPayECOrder.init();
   order.number = "180528105918955"
   order.detail = "DemoShop product 002"
   payment.order = order;
   payment.locale = locale_de ? SDKPayECLocale._de : SDKPayECLocale._en


```
----

//-

[TIP]
====
You can set optional parameters after the payment object is
created. Check the API documentation: http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECAlipayPayment.html[`SDKPayECAlipayPayment`]
for more details.
====

//-
[#MobilePaymentSDK_iOS_Alipay_Visualisaton]
==== Visualisation

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/alipay.png[Alipay Screen,align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_Alipay_Visualisaton_Card_CustomizingVisuals]
===== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECView`
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`

//-

/[#MobilePaymentSDK_iOS_WireTransfer]
=== POA/PIA WireTransfer

==== Supported https://docs.getneteurope.com/AppendixB.html[Transaction Types]

This payment method supports the following
https://docs.getneteurope.com/AppendixB.html[transaction
types]:

* *`SDKPayECTransactionTypeAuthorization`* - places the account holder’s
funds on hold, pending future capture, re-authorization or void
transaction.

[#MobilePaymentSDK_iOS_WireTransfer_basic_setup]
==== Basic Setup

[#MobilePaymentSDK_iOS_WireTransfer_basic_setup_cocoapods]
===== Cocoapods

Add to your app’s `Podfile` subspecs:
 
[source,ruby]
----
pod 'paymentSDK/WireTransfer',          '~> {{version}}'
----

[#MobilePaymentSDK_iOS_WireTransfer_basic_payment]
==== WireTransfer Payment

This is a code example for a basic WireTransfer payment:


[source,swift]
----
// 1. Initialize ``SDKPayECClient``
   do {
      try self.client = SDKPayECClient.init(hostname: hostname)
   } catch {
      // the device is checked during initialization for jailbreak.
      // It is risky to make payments on jailbroken devices.
      return
   }

// 2. Initialize payment object and set mandatory properties
// Parameters (amount, currency, transactionType) shall be sent to server for validation or just provided by server
// and used to generate signature. Signature MUST be generated on server side.
// Signature doc: https://document-center.wirecard.com/display/PTD/Signature+v2
// Secret Key shall never be stored in application.

   let payment = SDKPayECWireTransferPayment()
   payment.amount = AMOUNT
   payment.currency = SDKPayECCurrencyGetISOCode(SDKPayECCurrency.EUR)
   
   payment.transactionType = SDKPayECTransactionType.authorization

   let accountHolder = SDKPayECCustomerData.init()
   accountHolder.lastName = "Doe"
   payment.accountHolder = accountHolder
   
   let notif = SDKPayECNotification.init()
   notif.transactionState = SDKPayECTransactionState.success
   payment.notifications = [notif]

```
----

//-

[TIP]
====
You can set optional parameters after the payment object is
created. Check the API documentation: http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECWireTransferPayment.html[`SDKPayECWireTransferPayment`]
====

//-

[#MobilePaymentSDK_iOS_WireTransfer_Visualisaton]
==== Visualisation

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/wire-transfer.png[WireTransfer Screen,align=center, width=240, height=420]

// [#MobilePaymentSDK_iOS_WireTransfer_Visualisaton_Card_CustomizingVisuals]
// ===== Customizing Visuals

// To change colors within the SDK, set properties of the components, that
// conforms to UIAppearance protocol. Changing any of these will affect
// every module used in the SDK.

// [arabic]
// . `SDKPayECView`
// . `SDKPayECNavigationBar`

//-

[#MobilePaymentSDK_iOS_P24]
=== P24

==== Supported https://docs.getneteurope.com/AppendixB.html[Transaction Types]

This payment method supports the following
https://docs.getneteurope.com/AppendixB.html[transaction
types]:

* *`SDKPayECTransactionTypeDebit`* - todo.

[#MobilePaymentSDK_iOS_P24_basic_setup]
==== Basic Setup

[#MobilePaymentSDK_iOS_P24_basic_setup_cocoapods]
===== Cocoapods

Add to your app’s `Podfile` subspecs:
 
[source,ruby]
----
pod 'paymentSDK/P24',          '~> {{version}}'
----

[#MobilePaymentSDK_iOS_P24_basic_payment]
==== P24 Payment

This is a code example for a basic P24 payment:


[source,swift]
----
// 1. Initialize ``SDKPayECClient``
   do {
      try self.client = SDKPayECClient.init(hostname: hostname)
   } catch {
      // the device is checked during initialization for jailbreak.
      // It is risky to make payments on jailbroken devices.
      return
   }

// 2. Initialize payment object and set mandatory properties
// Parameters (amount, currency, transactionType) shall be sent to server for validation or just provided by server
// and used to generate signature. Signature MUST be generated on server side.
// Signature doc: https://document-center.wirecard.com/display/PTD/Signature+v2
// Secret Key shall never be stored in application.

   let payment = SDKPayECP24Payment()
   payment.amount = AMOUNT
   payment.currency = SDKPayECCurrencyGetISOCode(SDKPayECCurrency.PLN)

   payment.transactionType = SDKPayECTransactionType.debit

   let accountHolder = SDKPayECCustomerData.init()
   accountHolder.firstName = "John"
   accountHolder.lastName = "Doe"
   accountHolder.email = "joe.doe@mail.com"
   payment.accountHolder = accountHolder
```
----

//-

[TIP]
====
You can set optional parameters after the payment object is
created. Check the API documentation: http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECP24Payment.html[`SDKPayECP24Payment`]
for more details. P24 payment supports
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`]
recurring type.
====

//-

[#MobilePaymentSDK_iOS_P24_recurring_payment]
==== Recurring P24 Payment

On a basic level, recurring payments have two phases:

[arabic]
. The initial request, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeFirst`].
. The follow-up requests, which must include:
* periodic type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECPeriodicType.html[`SDKPayECPeriodicTypeRecurring`],
* sequence type set to
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Constants/SDKPayECSequenceType.html[`SDKPayECSequenceTypeRecurring`],
* http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]value
from the initial request.

So in order to create a recurring payment, you need to:

[arabic]
. Send a initial request with the appropriate periodic and sequence
flags,
. Save the values of
http://wirecard.github.io/paymentSDK-iOS/api/%7B%7Bversion%7D%7D/Classes/SDKPayECPayment.html#//api/name/parentTransactionID[`parentTransactionId`]
field generated in this first payment,
. Reference these values in the follow-up request, then send it with
appropriate periodic and sequence flags.

This is a code example for a first recurring P24 payment:
[source,swift]
----
// First payment 

   let firstPeriodicType = SDKPayECPeriodic() 
   firstPeriodicType.periodicType = .recurring
   firstPeriodicType.sequenceType = .first

   let payment = SDKPayECP24Payment()
   payment.merchantAccountID = merchantAccountID  
   payment.requestID = requestID
   payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
   payment.currency = "EUR"
   payment.transactionType = .debit
   let periodic = SDKPayECPeriodic()
   periodic.periodicType = periodicType
   periodic.sequenceType = sequenceType
   payment.periodic = firstPeriodicType
   payment.signature = signature

   let accountHolder = SDKPayECCustomerData.init()
   accountHolder.firstName = "John"
   accountHolder.lastName = "Doe"
   accountHolder.email = "joe.doe@mail.com"
   payment.accountHolder = accountHolder

   
   var parentTransactionID: String?
   self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
      // for each failure error object is provided;
      if let error = error {
         return
      }
      self.handleResponse(response)
   })

   // Handle first result
   func handleReponse(_ response: SDKPayECPaymentResponse?) {
      guard let response = response else { return }
      self.parentTransactionID = response.parentTransactionID
   }

   // Second payment using parentTransactionId

   let firstPeriodicType = SDKPayECPeriodic()
   firstPeriodicType.periodicType = .recurring
   firstPeriodicType.sequenceType = .final
   
   let payment = SDKPayECP24Payment()
   payment.merchantAccountID = merchantAccountID  
   payment.requestID = requestID
   payment.parentTransactionID = self.parentTransactionID
   payment.amount = NSDecimalNumber(mantissa: 199, exponent: -2, isNegative: NO)
   payment.currency = "EUR"
   payment.transactionType = .debit

   let periodic = SDKPayECPeriodic()
   periodic.periodicType = periodicType
   periodic.sequenceType = sequenceType
   payment.periodic = firstPeriodicType
   payment.signature = signature

   self.client?.make(payment, withCompletion:{(response: SDKPayECPaymentResponse?,error: Error?) in
      // for each failure error object is provided;
      if let error = error {
         return
      }
      self.handleResponse(response)
   })
```
----

[#MobilePaymentSDK_iOS_P24_Visualisaton]
==== Visualisation

image::images/07-01-02-integrating-mpsdk-on-ios/iOS/p24.png[P24 Screen,align=center, width=240, height=420]

[#MobilePaymentSDK_iOS_P24_Visualisaton_Card_CustomizingVisuals]
===== Customizing Visuals

To change colors within the SDK, set properties of the components, that
conforms to UIAppearance protocol. Changing any of these will affect
every module used in the SDK.

[arabic]
. `SDKPayECView`
. `SDKPayECCancelButtonImage`
. `SDKPayECCancelButton`
. `SDKPayECNavigationBar`
//-



